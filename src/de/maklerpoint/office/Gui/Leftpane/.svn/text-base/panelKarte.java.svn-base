/*
 *  Program:    MaklerPoint System
 *  Module:     Main
 *  Language:   Java / Swing
 *  Date:       2010/09/03 13:10
 *  Web:        http://www.maklerpoint.de
 *  Version:    0.6.1
 *
 *  Copyright (C) 2010 Yves Hoppe.  All Rights Reserved.
 *  See License.txt or http://www.maklerpoint.de/copyright for details.
 *
 *  This software is distributed WITHOUT ANY WARRANTY; without even the
 *  implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See
 *  above copyright notices for details.
 */

/*
 * panelKarte.java
 *
 * Created on Jul 28, 2010, 12:31:28 PM
 */

package de.acyrance.CRM.Gui.Leftpane;

import com.roots.map.MapPanel;
import de.acyrance.CRM.Gui.CRMView;
import de.acyrance.CRM.Gui.Karte.Karte;
import de.acyrance.CRM.Gui.Karte.KarteSuche;
import javax.swing.JOptionPane;

/**
 *
 * @author Yves Hoppe <info at yves-hoppe.de>
 */
public class panelKarte extends javax.swing.JPanel {

    private static CRMView crm;

    /** Creates new form panelKarte */
    public panelKarte(CRMView crm) {
        panelKarte.crm = crm;
        initComponents();
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        scroll_ergebnis = new javax.swing.JScrollPane();
        editor_ergebnis = new javax.swing.JEditorPane();
        jSeparator4 = new javax.swing.JSeparator();
        field_cardsearch = new javax.swing.JTextField();
        btn_search = new javax.swing.JButton();

        setName("Form"); // NOI18N

        scroll_ergebnis.setName("scroll_ergebnis"); // NOI18N

        org.jdesktop.application.ResourceMap resourceMap = org.jdesktop.application.Application.getInstance(de.acyrance.CRM.CRM.class).getContext().getResourceMap(panelKarte.class);
        editor_ergebnis.setContentType(resourceMap.getString("editor_ergebnis.contentType")); // NOI18N
        editor_ergebnis.setName("editor_ergebnis"); // NOI18N
        scroll_ergebnis.setViewportView(editor_ergebnis);

        jSeparator4.setName("jSeparator4"); // NOI18N

        field_cardsearch.setText(resourceMap.getString("field_cardsearch.text")); // NOI18N
        field_cardsearch.setName("field_cardsearch"); // NOI18N
        field_cardsearch.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                field_cardsearchMouseClicked(evt);
            }
        });
        field_cardsearch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                field_cardsearchActionPerformed(evt);
            }
        });

        btn_search.setIcon(resourceMap.getIcon("btn_search.icon")); // NOI18N
        btn_search.setToolTipText(resourceMap.getString("btn_search.toolTipText")); // NOI18N
        btn_search.setBorderPainted(false);
        btn_search.setName("btn_search"); // NOI18N
        btn_search.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_searchActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(field_cardsearch, javax.swing.GroupLayout.DEFAULT_SIZE, 144, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_search)
                .addContainerGap())
            .addComponent(jSeparator4, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 202, Short.MAX_VALUE)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(scroll_ergebnis, javax.swing.GroupLayout.DEFAULT_SIZE, 178, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(btn_search, javax.swing.GroupLayout.Alignment.LEADING, 0, 0, Short.MAX_VALUE)
                    .addComponent(field_cardsearch, javax.swing.GroupLayout.Alignment.LEADING))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jSeparator4, javax.swing.GroupLayout.PREFERRED_SIZE, 10, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(scroll_ergebnis, javax.swing.GroupLayout.DEFAULT_SIZE, 454, Short.MAX_VALUE)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents

    private void btn_searchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_searchActionPerformed
        String ziel = field_cardsearch.getText();

        search(ziel);
    }//GEN-LAST:event_btn_searchActionPerformed

    private void field_cardsearchActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_field_cardsearchActionPerformed
        if(this.field_cardsearch.getText().equalsIgnoreCase("Adresse")){
            this.field_cardsearch.setText("");
        }
    }//GEN-LAST:event_field_cardsearchActionPerformed

    private void field_cardsearchMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_field_cardsearchMouseClicked
        if(this.field_cardsearch.getText().equalsIgnoreCase("Adresse")){
            this.field_cardsearch.setText("");
        }
    }//GEN-LAST:event_field_cardsearchMouseClicked

    public static void search(String ziel) {
        if(ziel == null) {
            JOptionPane.showMessageDialog(null, "Bitte geben Sie eine Adresse in das Suchfeld ein um nach einem Ort zu suchen",
                    "Bitte geben Sie eine Adresse ein", JOptionPane.INFORMATION_MESSAGE);
            return;
        }

        MapPanel map = Karte.getMap(6.94, 50.95, 10);

        if(crm.toolWindowManager.getContentManager().getContent("map") == null) {
            crm.toolWindowManager.getContentManager().addContent("map",
                                                                 "Karte",
                                                                 null,
                                                                 map);
        }

        crm.toolWindowManager.getContentManager().getContent("map").setSelected(true);

//        panel_content.removeAll();
//        panel_content.add(map, BorderLayout.CENTER);
        KarteSuche.doSearch(ziel, crm, map);
//        panel_content.revalidate();
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    public static javax.swing.JButton btn_search;
    public static javax.swing.JEditorPane editor_ergebnis;
    public static javax.swing.JTextField field_cardsearch;
    private javax.swing.JSeparator jSeparator4;
    private javax.swing.JScrollPane scroll_ergebnis;
    // End of variables declaration//GEN-END:variables

}
